<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>MySQL | KILLAR&#39;S BLOG</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.2">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <[object Object]></[object Object]>
    <meta name="description" content="种一棵树最好的时间是十年前，其次是现在">
    <link rel="preload" href="/vuepress.github.io/assets/css/0.styles.0b6018b1.css" as="style"><link rel="preload" href="/vuepress.github.io/assets/js/app.ba1ea9b6.js" as="script"><link rel="preload" href="/vuepress.github.io/assets/js/2.fc02e046.js" as="script"><link rel="preload" href="/vuepress.github.io/assets/js/9.bca2c1df.js" as="script"><link rel="prefetch" href="/vuepress.github.io/assets/js/10.1300801c.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/11.56b53ed5.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/12.df0caf41.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/13.f464cad7.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/14.090823b1.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/15.d541e777.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/16.37d11882.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/17.a12739b5.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/18.38751be7.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/19.c66235c6.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/20.133bcb93.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/21.a193bcac.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/22.31928e21.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/23.7bcb1681.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/24.6bb0b429.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/25.0d80a0db.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/26.20521376.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/27.dc404bc6.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/28.8e07fd85.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/29.8800b1ae.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/3.ddd9ca10.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/30.de2774b1.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/31.7775b765.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/32.1c7bf669.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/33.ea70e671.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/4.c1ad3322.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/5.cade1933.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/6.6137ad34.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/7.7149568d.js"><link rel="prefetch" href="/vuepress.github.io/assets/js/8.bf485cae.js">
    <link rel="stylesheet" href="/vuepress.github.io/assets/css/0.styles.0b6018b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/vuepress.github.io/" class="router-link-active no-logo home-link"><!----> <span class="site-name">KILLAR'S BLOG</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/vuepress.github.io/" class="router-link-active">
          主页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/vuepress.github.io/components/blog/">
          博客
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          技术
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          软考
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          生活
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress.github.io/components/database/mysql/" aria-current="page" title="MySQL" class="active sidebar-link">MySQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress.github.io/components/database/mysql/#mysql主从复制（master-slave）" title="MySQL主从复制（Master-Slave）" class="sidebar-link">MySQL主从复制（Master-Slave）</a></li></ul></li><li><a href="/vuepress.github.io/components/database/mongodb/" title="MongoDB" class="sidebar-link">MongoDB</a></li><li><a href="/vuepress.github.io/components/database/redis/" title="Redis" class="sidebar-link">Redis</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h2 id="mysql主从复制（master-slave）"><a href="#mysql主从复制（master-slave）" class="header-anchor">#</a> MySQL主从复制（Master-Slave）</h2> <ul><li>主从复制：是用来建立一个和主数据库完全一样的数据库环境，称为从数据库；主数据库一般是准实时的业务数据库。</li> <li>主从复制的作用：做数据的热备，从数据库作为后备数据库，主数据库服务器故障后，可切换到从数据库继续工作，避免数据丢失。</li> <li>假设主服务器的IP地址是192.168.11.127，从服务器的IP地址是192.168.11.129。</li></ul> <p>一、主服务器（Master）的配置</p> <ol><li>安装MySQL，安装服务mysqld install MySQL-Master，新建数据库property1</li> <li>打开my.ini文件，在文件末尾加入下面内容：</li></ol> <div class="language- extra-class"><pre class="language-text"><code># server-id指定服务器编号，如果此项已存在不添加
server-id=1
# log-bin指日志的存储位置及文件名
log-bin=D:/mysql-log/log-bin.log
# binlog-do-db指进行日志记录的数据库名称，如果存在多个数据库，则用逗号&quot;,&quot;分隔。
binlog-do-db=property1
</code></pre></div><ol start="3"><li>重启MySQL服务</li> <li>开通从服务器（Slave）访问主服务器（Master）的权限
进入MySQL的命令窗口
帐号：root，密码：123456 ，'192.168.11.129'为Salve机器的IP，即；允许129机器通过root/123456 访问Master</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mysq&gt;grant replication slave on . to 'root'@'192.168.11.129' identified by '123546';
</code></pre></div><ol start="5"><li>查看授权信息</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mysql&gt;show master status \G;
</code></pre></div><img src="/vuepress.github.io/assets/img/database/s1.png" alt="变更控制系统"> <p>注意：记住log-bin.000008和107，会在Slave机器上用到。</p> <p>二、从服务器（Slave）的配置</p> <ol><li>安装MySQL，安装服务mysqld install MySQL-Slave，新建数据库property1</li> <li>打开my.ini文件，在文件末尾加入下面内容：</li></ol> <div class="language- extra-class"><pre class="language-text"><code># server-id 全局唯一的ID 不可与Master的ID重复 ，如果此项已存在不添加
server-id=2
# log-bin指日志的存储位置及文件名
log-bin=D:/mysql-slaver-log/log-bin.log
# binlog-do-db指进行日志记录的数据库名称，如果存在多个数据库，则用逗号&quot;,&quot;分隔。
binlog-do-db=property1
</code></pre></div><p>注意：server-id 默认会有配置，检查一下，避免重复</p> <ol start="3"><li>重启MySQL服务</li> <li>设置主库的信息，将从库和主库联系起来</li></ol> <div class="language- extra-class"><pre class="language-text"><code>Mysq;&gt;change master to
master_host='192.168.11.127',
master_user='root',
master_password='123456',
master_log_file='log-bin.000008',
master_log_pos=107;
</code></pre></div><p>注意：这里的master_log_file和master_log_pos就是上面主库的信息。</p> <ol start="5"><li>启动（如果Slave已经启动，先stop slave;再start salve;）</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mysq;&gt;start slave;
</code></pre></div><ol start="6"><li>查看slave启动的状态</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mysq;&gt;show slave status \G;
</code></pre></div><img src="/vuepress.github.io/assets/img/database/s2.png" alt="变更控制系统"> <p>如提示：Slave_IO_Running:Yes<br>
Slave_SQL_Running:Yes 则表明，启动成功。</p> <p>三、测试
在Master的property1数据库t_wlkx_up表新增一条数据后，即可看到Slave的property1数据库的t_wlkx_up表也增加了一条相同数据。</p> <img src="/vuepress.github.io/assets/img/database/s3.png" alt="变更控制系统"></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/13/2020, 6:27:38 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/vuepress.github.io/components/database/mongodb/">
        MongoDB
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div><div></div></div></div>
    <script src="/vuepress.github.io/assets/js/app.ba1ea9b6.js" defer></script><script src="/vuepress.github.io/assets/js/2.fc02e046.js" defer></script><script src="/vuepress.github.io/assets/js/9.bca2c1df.js" defer></script>
  </body>
</html>